<%- include('../partials/header.ejs') %>

<h1><%= movie.Title %></h1>
<% if (movie.Poster !== "N/A") { %>
    <img src="<%= movie.Poster %>" alt="<% movie.Title %>'s release poster">
<% } else { %>
    <p>No movie poster found... </p>
<% } %>
<p>year: <%= movie.Year %></p>
<p>rated: <%= movie.Rated %></p>
<p>genre: <%= movie.Genre %></p>
<p>Summary: <%= movie.Plot %></p>

<div class="well">
    <form method="POST" action="/movies/<%= movie.imdbID %>/favorites">
      <input hidden type="text" name="title" value="<%= movie.Title %>">
      <input hidden type="text" name="imdbID" value="<%= movie.imdbID %>">
      <button class="btn btn-primary" type="submit">Add to Favorite Movies</button>
    </form>
  </div>

  <div class="well">
    <h4>Leave a comment:</h4>
    <form method="POST" action="/comments">
        <div class="form-group">
            <input type="hidden" name="movieId" value="<%= movie.imdbID %>">
          <div class="form-group">
            <textarea type="text" class="form-control" id="content" name="content" placeholder="Add a comment..." required></textarea>
          </div>
        
          <input type="submit" class="btn btn-primary">
        </div>
      </form>
  </div>

  <div class="well">    
    <h3>Comments:</h3>
    <% if (comments.length > 0) { %>
        <% comments.forEach((comment, i) => { %>
            <span>
                <p><%= comment.user.email %>: </p>
                <p><%= comment.content %></p>
            </span>
        <% }) %>
    <% } else { %>
        <p>No comments yet.</p> 
    <% } %>
  </div>

<%- include('../partials/footer.ejs') %>
